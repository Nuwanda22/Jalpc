---
layout: post
title:  "데이터베이스 트랜잭션"
date:   2016-11-15
desc: "트랜잭션에 대한 조사"
keywords: "database,sql,transaction"
categories: [Database]
tags: [database]
icon: fa-database
---

# 정의
데이터베이스에서 데이터에 대한 하나의 논리적 실행단계

예를 들어, 계좌이체를 트랜잭션이라고 할 수 있는데, 계좌이체는 '보내는 사람 금액 감소', '받는 사람 금액 증가'가 한 동작인 것과 같다.


# ACID
데이터베이스 시스템은 트랜잭션에 대해 ACID를 보장한다. 

ACID란 데이터베이스 트랜잭션이 안전하게 수행된다는 것을 보장하기 위한 성질의 약자로 다음과 같다.

#### 원자성 (Atomicity)
* 트랜잭션의 처리는 완전히 끝나지 않았을 경우에는 전혀 이루어지지 않은 것과 같아야 한다. 
* 트랜잭션과 관련된 작업들이 부분적으로 실행되다가 중단되지 않는 것을 보장하는 성질. 
* 중간 단계까지 실행되고 실패하는 일이 없도록 함.

#### 일관성 (Consistency)
* 트랜잭션들 간의 영향이 한 방향으로만 전달되어야 한다.
* 트랜잭션이 실행을 성공적으로 완료하면 언제나 일관성 있는 데이터베이스 상태로 유지하는 것. 

#### 고립성 (Isolation)
* 트랜잭션의 부분적인 상태를 다른 트랜잭션에 제공해서는 안 된다. 
* 트랜잭션을 수행 시 다른 트랜잭션의 연산 작업이 끼어들지 못하도록 보장하는 것.

#### 지속성 (Durability)
* 성공적인 트랜잭션의 수행 후에는 반드시 데이터베이스에 반영되어야 한다.
* 성공적으로 수행된 트랜잭션은 영원히 반영되어야 함. 
* 트랜잭션은 로그에 모든 것이 저장된 후에만 commit 상태로 간주될 수 있다.

그러나 실제로는 성능향상을 위해 이런 특성들이 종종 완화되곤 한다.

# SQL
트랜잭션은 다음 SQL과 같이 실행된다.

begin tran_name
-- 트랜잭션
-- 내용
commit tran_name

트랜잭션이 성공리에 끝났을 때 이루어지는 데이터베이스의 갱신을 "commit", 
트랜잭션이 실패했을 때 데이터베이스의 수정 내용이 취소되는 것을 "rollback"이라고 부른다.